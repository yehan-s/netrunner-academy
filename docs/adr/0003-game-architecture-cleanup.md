# ADR 0003：游戏核心代码架构梳理（App 组件解耦）

## 状态

Accepted（已采纳，当前阶段拆分已完成）

## 背景

当前 `App.tsx` 承担了过多职责：状态管理、浏览器窗口布局、DevTools 尺寸拖拽、网络流量模拟、关卡成功判定等全部堆在一个文件里，嵌套层级深，难以维护，也不符合“函数只做一件事”的要求。后续要持续新增关卡与工具模拟功能，如果不先做架构梳理，复杂度会迅速失控。

## 决策

- 逐步将 UI 无关的逻辑从 `App.tsx` 中抽离到独立模块或自定义 Hook，优先拆出：
  - DevTools 尺寸与停靠位置的拖拽逻辑（已使用 `useDevToolsResize` 封装）；
  - 网络请求与关卡判定的模拟逻辑（已集中到 `engine/networkEngine.ts` 中）。
- 保持现有 UI 与行为完全一致，拆分只改变“代码组织方式”，不改动数据结构与对外接口。
- 引入 `hooks/` 目录存放客户端专用 Hook，用于封装状态和副作用逻辑，让页面组件更关注布局与渲染。

## 影响

- `App.tsx` 变得更薄，主要负责 OS 状态管理与布局渲染，后续功能新增更易定位与拆分。
- DevTools 尺寸拖拽逻辑以 Hook 形式复用，未来如果增加其他窗口布局场景，可以直接复用该 Hook。
- 网络模拟与关卡判定集中在 `engine/networkEngine.ts`，便于后续扩展和测试，同时保持现有行为不变。
